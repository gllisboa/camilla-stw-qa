<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1515px" preserveAspectRatio="none" style="width:2515px;height:1515px;background:#FFFFFF;" version="1.1" viewBox="0 0 2515 1515" width="2515px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="1300.7109" style="stroke:#181818;stroke-width:1.0;" width="10" x="470.5" y="114.9609"/><rect fill="#FFFFFF" height="1270.3594" style="stroke:#181818;stroke-width:1.0;" width="10" x="654.5" y="145.3125"/><rect fill="#FFFFFF" height="1166.3047" style="stroke:#181818;stroke-width:1.0;" width="10" x="884" y="219.0156"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1107" y="249.3672"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1288.5" y="401.125"/><rect fill="#FFFFFF" height="589.625" style="stroke:#181818;stroke-width:1.0;" width="10" x="1288.5" y="765.3438"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1517.5" y="552.8828"/><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1517.5" y="1207.5625"/><rect fill="#FFFFFF" height="294.8125" style="stroke:#181818;stroke-width:1.0;" width="10" x="1742.5" y="839.0469"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2026.5" y="704.6406"/><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="2263" y="986.4531"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2475" y="310.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2475" y="461.8281"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2475" y="613.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="475" x2="475" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="659" x2="659" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="889" x2="889" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1111.5" x2="1111.5" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1293.5" x2="1293.5" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1522.5" x2="1522.5" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1747.5" x2="1747.5" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2031" x2="2031" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2268" x2="2268" y1="82.6094" y2="1433.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2480" x2="2480" y1="82.6094" y2="1433.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="5" y="79.5332">User</text><ellipse cx="22.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.5,21.5 L22.5,48.5 M9.5,29.5 L35.5,29.5 M22.5,48.5 L9.5,63.5 M22.5,48.5 L35.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="5" y="1447.2051">User</text><ellipse cx="22.5" cy="1458.7813" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.5,1466.7813 L22.5,1493.7813 M9.5,1474.7813 L35.5,1474.7813 M22.5,1493.7813 L9.5,1508.7813 M22.5,1493.7813 L35.5,1508.7813 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59" x="446" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="453" y="71.5332">Routes</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59" x="446" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="453" y="1454.2051">Routes</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="289" x="515" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="275" x="522" y="71.5332">upvotePostController: UpvotePostController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="289" x="515" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="275" x="522" y="1454.2051">upvotePostController: UpvotePostController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="814" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="821" y="71.5332">useCase: UpvotePost</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="814" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="821" y="1454.2051">useCase: UpvotePost</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="1014.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="1021.5" y="71.5332">memberRepo: IMemberRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="1014.5" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="1021.5" y="1454.2051">memberRepo: IMemberRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148" x="1219.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="1226.5" y="71.5332">postRepo: IPostRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148" x="1219.5" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="1226.5" y="1454.2051">postRepo: IPostRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="1412.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206" x="1419.5" y="71.5332">postVotesRepo: IPostVotesRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="1412.5" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206" x="1419.5" y="1454.2051">postVotesRepo: IPostVotesRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1642.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1649.5" y="71.5332">commentRepo: ICommentRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1642.5" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1649.5" y="1454.2051">commentRepo: ICommentRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171" x="1946" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="1953" y="71.5332">postService: PostService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171" x="1946" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="1953" y="1454.2051">postService: PostService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="282" x="2127" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="268" x="2134" y="71.5332">commentVotesRepo: ICommentVotesRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="282" x="2127" y="1432.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="268" x="2134" y="1454.2051">commentVotesRepo: ICommentVotesRepo</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="2454" y="79.5332">MySQL</text><path d="M2462,29 C2462,19 2480,19 2480,19 C2480,19 2498,19 2498,29 L2498,55 C2498,65 2480,65 2480,65 C2480,65 2462,65 2462,55 L2462,29 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M2462,29 C2462,39 2480,39 2480,39 C2480,39 2498,39 2498,29 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="2454" y="1447.2051">MySQL</text><path d="M2462,1460.2813 C2462,1450.2813 2480,1450.2813 2480,1450.2813 C2480,1450.2813 2498,1450.2813 2498,1460.2813 L2498,1486.2813 C2498,1496.2813 2480,1496.2813 2480,1496.2813 C2480,1496.2813 2462,1496.2813 2462,1486.2813 L2462,1460.2813 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M2462,1460.2813 C2462,1470.2813 2480,1470.2813 2480,1470.2813 C2480,1470.2813 2498,1470.2813 2498,1460.2813 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#FFFFFF" height="1300.7109" style="stroke:#181818;stroke-width:1.0;" width="10" x="470.5" y="114.9609"/><rect fill="#FFFFFF" height="1270.3594" style="stroke:#181818;stroke-width:1.0;" width="10" x="654.5" y="145.3125"/><rect fill="#FFFFFF" height="1166.3047" style="stroke:#181818;stroke-width:1.0;" width="10" x="884" y="219.0156"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1107" y="249.3672"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1288.5" y="401.125"/><rect fill="#FFFFFF" height="589.625" style="stroke:#181818;stroke-width:1.0;" width="10" x="1288.5" y="765.3438"/><rect fill="#FFFFFF" height="121.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1517.5" y="552.8828"/><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="1517.5" y="1207.5625"/><rect fill="#FFFFFF" height="294.8125" style="stroke:#181818;stroke-width:1.0;" width="10" x="1742.5" y="839.0469"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2026.5" y="704.6406"/><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="2263" y="986.4531"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2475" y="310.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2475" y="461.8281"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2475" y="613.5859"/><polygon fill="#181818" points="458.5,110.9609,468.5,114.9609,458.5,118.9609,462.5,114.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="22.5" x2="464.5" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="29.5" y="110.1045">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418" x="40.5" y="110.1045">call endpoint (method: "POST", route: "/upvote", header: "Authorization")</text><polygon fill="#181818" points="642.5,141.3125,652.5,145.3125,642.5,149.3125,646.5,145.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="648.5" y1="145.3125" y2="145.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="487.5" y="140.4561">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="498.5" y="140.4561">execute(req, res)</text><line style="stroke:#181818;stroke-width:1.0;" x1="664.5" x2="706.5" y1="175.6641" y2="175.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="706.5" x2="706.5" y1="175.6641" y2="188.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="665.5" x2="706.5" y1="188.6641" y2="188.6641"/><polygon fill="#181818" points="675.5,184.6641,665.5,188.6641,675.5,192.6641,671.5,188.6641" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="671.5" y="170.8076">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="682.5" y="170.8076">executeImpl(req, res)</text><polygon fill="#181818" points="872,215.0156,882,219.0156,872,223.0156,876,219.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="664.5" x2="878" y1="219.0156" y2="219.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="671.5" y="214.1592">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="682.5" y="214.1592">execute(dto)</text><polygon fill="#181818" points="1095,245.3672,1105,249.3672,1095,253.3672,1099,249.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="1101" y1="249.3672" y2="249.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="901" y="244.5107">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="912" y="244.5107">getMemberByUserId(req.userId)</text><polygon fill="#181818" points="2468,275.7188,2478,279.7188,2468,283.7188,2472,279.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1117" x2="2474" y1="279.7188" y2="279.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1124" y="274.8623">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1135" y="274.8623">createBaseQuery()</text><polygon fill="#181818" points="2463,306.0703,2473,310.0703,2463,314.0703,2467,310.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1117" x2="2469" y1="310.0703" y2="310.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1124" y="305.2139">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="1135" y="305.2139">MemberModel.findOne</text><polygon fill="#181818" points="1128,336.4219,1118,340.4219,1128,344.4219,1124,340.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1122" x2="2479" y1="340.4219" y2="340.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1134" y="335.5654">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="1145" y="335.5654">Member</text><polygon fill="#181818" points="905,366.7734,895,370.7734,905,374.7734,901,370.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="899" x2="1111" y1="370.7734" y2="370.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="911" y="365.917">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="922" y="365.917">Member</text><polygon fill="#181818" points="1276.5,397.125,1286.5,401.125,1276.5,405.125,1280.5,401.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="1282.5" y1="401.125" y2="401.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="901" y="396.2686">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="919" y="396.2686">getPostBySlug(req.slug)</text><polygon fill="#181818" points="2468,427.4766,2478,431.4766,2468,435.4766,2472,431.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="2474" y1="431.4766" y2="431.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1305.5" y="426.6201">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1323.5" y="426.6201">createBaseQuery()</text><polygon fill="#181818" points="2463,457.8281,2473,461.8281,2463,465.8281,2467,461.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="2469" y1="461.8281" y2="461.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1305.5" y="456.9717">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1323.5" y="456.9717">PostModel.findOne</text><polygon fill="#181818" points="1309.5,488.1797,1299.5,492.1797,1309.5,496.1797,1305.5,492.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1303.5" x2="2479" y1="492.1797" y2="492.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1315.5" y="487.3232">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="1333.5" y="487.3232">Post</text><polygon fill="#181818" points="905,518.5313,895,522.5313,905,526.5313,901,522.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="899" x2="1292.5" y1="522.5313" y2="522.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="911" y="517.6748">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="929" y="517.6748">Post</text><polygon fill="#181818" points="1505.5,548.8828,1515.5,552.8828,1505.5,556.8828,1509.5,552.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="1511.5" y1="552.8828" y2="552.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="901" y="548.0264">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359" x="919" y="548.0264">getVotesForPostByMemberId(post.postId, member.memberId)</text><polygon fill="#181818" points="2468,579.2344,2478,583.2344,2468,587.2344,2472,583.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1527.5" x2="2474" y1="583.2344" y2="583.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1534.5" y="578.3779">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1552.5" y="578.3779">createBaseQuery()</text><polygon fill="#181818" points="2463,609.5859,2473,613.5859,2463,617.5859,2467,613.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1527.5" x2="2469" y1="613.5859" y2="613.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1534.5" y="608.7295">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="1552.5" y="608.7295">PostVote.findAll</text><polygon fill="#181818" points="1538.5,639.9375,1528.5,643.9375,1538.5,647.9375,1534.5,643.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532.5" x2="2479" y1="643.9375" y2="643.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1544.5" y="639.0811">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="1562.5" y="639.0811">PostVote[]</text><polygon fill="#181818" points="905,670.2891,895,674.2891,905,678.2891,901,674.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="899" x2="1521.5" y1="674.2891" y2="674.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="911" y="669.4326">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="929" y="669.4326">PostVote[]</text><polygon fill="#181818" points="2014.5,700.6406,2024.5,704.6406,2014.5,708.6406,2018.5,704.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="2020.5" y1="704.6406" y2="704.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="901" y="699.7842">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="919" y="699.7842">upvotePost(post, member, existingVotesOnPostbyMember)</text><polygon fill="#181818" points="905,730.9922,895,734.9922,905,738.9922,901,734.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="899" x2="2030.5" y1="734.9922" y2="734.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="911" y="730.1357">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="929" y="730.1357">Result.ok</text><polygon fill="#181818" points="1276.5,761.3438,1286.5,765.3438,1276.5,769.3438,1280.5,765.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="1282.5" y1="765.3438" y2="765.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="901" y="760.4873">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="919" y="760.4873">save(post)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="1340.5" y1="795.6953" y2="795.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="1340.5" x2="1340.5" y1="795.6953" y2="808.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="1299.5" x2="1340.5" y1="808.6953" y2="808.6953"/><polygon fill="#181818" points="1309.5,804.6953,1299.5,808.6953,1309.5,812.6953,1305.5,808.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1305.5" y="790.8389">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="1323.5" y="790.8389">saveComments(post.comments)</text><polygon fill="#181818" points="1730.5,835.0469,1740.5,839.0469,1730.5,843.0469,1734.5,839.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="1736.5" y1="839.0469" y2="839.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1305.5" y="834.1904">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="1323.5" y="834.1904">saveBulk(comments.getItems())</text><line style="stroke:#181818;stroke-width:1.0;" x1="1752.5" x2="1794.5" y1="869.3984" y2="869.3984"/><line style="stroke:#181818;stroke-width:1.0;" x1="1794.5" x2="1794.5" y1="869.3984" y2="882.3984"/><line style="stroke:#181818;stroke-width:1.0;" x1="1753.5" x2="1794.5" y1="882.3984" y2="882.3984"/><polygon fill="#181818" points="1763.5,878.3984,1753.5,882.3984,1763.5,886.3984,1759.5,882.3984" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1759.5" y="864.542">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="1777.5" y="864.542">save(comment)</text><polygon fill="#181818" points="2468,908.75,2478,912.75,2468,916.75,2472,912.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1752.5" x2="2474" y1="912.75" y2="912.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1759.5" y="907.8936">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="1777.5" y="907.8936">Create or Update comment</text><line style="stroke:#181818;stroke-width:1.0;" x1="1752.5" x2="1794.5" y1="943.1016" y2="943.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="1794.5" x2="1794.5" y1="943.1016" y2="956.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="1753.5" x2="1794.5" y1="956.1016" y2="956.1016"/><polygon fill="#181818" points="1763.5,952.1016,1753.5,956.1016,1763.5,960.1016,1759.5,956.1016" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1759.5" y="938.2451">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="1777.5" y="938.2451">saveCommentVotes(comment.getVotes())</text><polygon fill="#181818" points="2251,982.4531,2261,986.4531,2251,990.4531,2255,986.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1752.5" x2="2257" y1="986.4531" y2="986.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1759.5" y="981.5967">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="1777.5" y="981.5967">saveBulk(commentVotes)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2273" x2="2315" y1="1016.8047" y2="1016.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="2315" x2="2315" y1="1016.8047" y2="1029.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="2274" x2="2315" y1="1029.8047" y2="1029.8047"/><polygon fill="#181818" points="2284,1025.8047,2274,1029.8047,2284,1033.8047,2280,1029.8047" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="2280" y="1011.9482">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="2298" y="1011.9482">delete(vote)</text><polygon fill="#181818" points="2468,1056.1563,2478,1060.1563,2468,1064.1563,2472,1060.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2273" x2="2474" y1="1060.1563" y2="1060.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="2280" y="1055.2998">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="2298" y="1055.2998">CommentVoteModel.destroy</text><line style="stroke:#181818;stroke-width:1.0;" x1="2273" x2="2315" y1="1090.5078" y2="1090.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="2315" x2="2315" y1="1090.5078" y2="1103.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="2274" x2="2315" y1="1103.5078" y2="1103.5078"/><polygon fill="#181818" points="2284,1099.5078,2274,1103.5078,2284,1107.5078,2280,1103.5078" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="2280" y="1085.6514">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="2298" y="1085.6514">save(vote)</text><polygon fill="#181818" points="2468,1129.8594,2478,1133.8594,2468,1137.8594,2472,1133.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2268" x2="2474" y1="1133.8594" y2="1133.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="2275" y="1129.0029">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="2293" y="1129.0029">CommentVoteModel.create</text><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="1340.5" y1="1164.2109" y2="1164.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1340.5" x2="1340.5" y1="1164.2109" y2="1177.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1299.5" x2="1340.5" y1="1177.2109" y2="1177.2109"/><polygon fill="#181818" points="1309.5,1173.2109,1299.5,1177.2109,1309.5,1181.2109,1305.5,1177.2109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1305.5" y="1159.3545">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1323.5" y="1159.3545">savePostVotes(post.getVotes())</text><polygon fill="#181818" points="1505.5,1203.5625,1515.5,1207.5625,1505.5,1211.5625,1509.5,1207.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1298.5" x2="1511.5" y1="1207.5625" y2="1207.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1305.5" y="1202.7061">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="1323.5" y="1202.7061">saveBulk(postVotes)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1527.5" x2="1569.5" y1="1237.9141" y2="1237.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="1569.5" x2="1569.5" y1="1237.9141" y2="1250.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1569.5" y1="1250.9141" y2="1250.9141"/><polygon fill="#181818" points="1538.5,1246.9141,1528.5,1250.9141,1538.5,1254.9141,1534.5,1250.9141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1534.5" y="1233.0576">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="1552.5" y="1233.0576">delete(vote)</text><polygon fill="#181818" points="2468,1277.2656,2478,1281.2656,2468,1285.2656,2472,1281.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1527.5" x2="2474" y1="1281.2656" y2="1281.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1534.5" y="1276.4092">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="1552.5" y="1276.4092">PostVoteModel.destroy</text><line style="stroke:#181818;stroke-width:1.0;" x1="1527.5" x2="1569.5" y1="1311.6172" y2="1311.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1569.5" x2="1569.5" y1="1311.6172" y2="1324.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1569.5" y1="1324.6172" y2="1324.6172"/><polygon fill="#181818" points="1538.5,1320.6172,1528.5,1324.6172,1538.5,1328.6172,1534.5,1324.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1534.5" y="1306.7607">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="1552.5" y="1306.7607">save(vote)</text><polygon fill="#181818" points="2468,1350.9688,2478,1354.9688,2468,1358.9688,2472,1354.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522.5" x2="2474" y1="1354.9688" y2="1354.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1529.5" y="1350.1123">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1547.5" y="1350.1123">PostVoteModel.create</text><polygon fill="#181818" points="675.5,1381.3203,665.5,1385.3203,675.5,1389.3203,671.5,1385.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="669.5" x2="888" y1="1385.3203" y2="1385.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="681.5" y="1380.4639">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="699.5" y="1380.4639">Result.ok&lt;void&gt;()</text><polygon fill="#181818" points="486.5,1411.6719,476.5,1415.6719,486.5,1419.6719,482.5,1415.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="658.5" y1="1415.6719" y2="1415.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="492.5" y="1410.8154">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="510.5" y="1410.8154">ok(res)</text><!--MD5=[b59b2f662fb379f955c9b035485d121b]
@startuml SD-UpVotePost
autonumber 

actor User
participant Routes
participant "upvotePostController: UpvotePostController" as UpvotePostController
participant "useCase: UpvotePost" as UpvotePostUseCase
participant "memberRepo: IMemberRepo" as IMemberRepo
participant "postRepo: IPostRepo" as IPostRepo
participant "postVotesRepo: IPostVotesRepo" as IPostVotesRepo
participant "commentRepo: ICommentRepo" as ICommentRepo
participant "postService: PostService" as PostService
participant "commentVotesRepo: ICommentVotesRepo" as ICommentVotesRepo
database MySQL as database

User -> Routes: call endpoint (method: "POST", route: "/upvote", header: "Authorization")
    activate Routes
    Routes -> UpvotePostController: execute(req, res) 
    activate UpvotePostController
        UpvotePostController -> UpvotePostController: executeImpl(req, res)
        UpvotePostController -> UpvotePostUseCase: execute(dto)
        activate UpvotePostUseCase
            UpvotePostUseCase -> IMemberRepo: getMemberByUserId(req.userId)
            activate IMemberRepo
                IMemberRepo -> database: createBaseQuery()
                IMemberRepo -> database: MemberModel.findOne
                activate database
                    database -> IMemberRepo: Member
                deactivate database
                IMemberRepo -> UpvotePostUseCase: Member 
            deactivate IMemberRepo

            UpvotePostUseCase -> IPostRepo: getPostBySlug(req.slug)
            activate IPostRepo
                IPostRepo -> database: createBaseQuery()
                IPostRepo -> database: PostModel.findOne
                activate database
                    database -> IPostRepo: Post
                deactivate database
                IPostRepo -> UpvotePostUseCase: Post
            deactivate IPostRepo

            UpvotePostUseCase -> IPostVotesRepo: getVotesForPostByMemberId(post.postId, member.memberId)
            activate IPostVotesRepo
                IPostVotesRepo -> database: createBaseQuery()
                IPostVotesRepo -> database: PostVote.findAll
                activate database
                    database -> IPostVotesRepo: PostVote[]
                deactivate database
                IPostVotesRepo -> UpvotePostUseCase: PostVote[]
            deactivate IPostVotesRepo

            UpvotePostUseCase -> PostService: upvotePost(post, member, existingVotesOnPostbyMember)
            activate PostService
                PostService -> UpvotePostUseCase: Result.ok
            deactivate PostService

            UpvotePostUseCase -> IPostRepo: save(post)
            activate IPostRepo
                    IPostRepo -> IPostRepo: saveComments(post.comments)
                    IPostRepo -> ICommentRepo: saveBulk(comments.getItems())
                    activate ICommentRepo
                        ICommentRepo -> ICommentRepo: save(comment)
                        ICommentRepo -> database: Create or Update comment
                        ICommentRepo -> ICommentRepo: saveCommentVotes(comment.getVotes())
                        ICommentRepo -> ICommentVotesRepo: saveBulk(commentVotes)
                        activate ICommentVotesRepo
                            ICommentVotesRepo -> ICommentVotesRepo: delete(vote)
                            ICommentVotesRepo -> database: CommentVoteModel.destroy
                            ICommentVotesRepo -> ICommentVotesRepo: save(vote)
                            ICommentVotesRepo -> database: CommentVoteModel.create
                        deactivate ICommentVotesRepo
                    deactivate ICommentRepo

                    IPostRepo -> IPostRepo: savePostVotes(post.getVotes())
                    IPostRepo -> IPostVotesRepo: saveBulk(postVotes)
                    activate IPostVotesRepo
                        IPostVotesRepo -> IPostVotesRepo: delete(vote)
                        IPostVotesRepo -> database: PostVoteModel.destroy
                        IPostVotesRepo -> IPostVotesRepo: save(vote)
                        IPostVotesRepo -> database: PostVoteModel.create
                    deactivate IPostVotesRepo
            deactivate IPostRepo

            UpvotePostUseCase -> UpvotePostController:  Result.ok<void>()
            deactivate UpvotePostUseCase

        UpvotePostController -> Routes: ok(res)
        deactivate UpvotePostController
    deactivate Routes
@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>